(function(u){function b(a,c,k){if(k!==h)return a instanceof b?a:"undefined"===typeof a?n:b.parse(a);for(a=a||[];a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?c||1:0}var h={};b._construct=function(a,c){return new b(a,c,h)};b.base=1E7;b.base_log10=7;var n=new b([],0,h);b.ZERO=n;var p=new b([1],1,h);b.ONE=p;var s=new b(p._d,-1,h);b.M_ONE=s;b._0=n;b._1=p;b.small=[n,p,new b([2],1,h),new b([3],1,h),new b([4],1,h),new b([5],1,h),new b([6],1,h),new b([7],1,h),new b([8],1,h),new b([9],1,
h),new b([10],1,h),new b([11],1,h),new b([12],1,h),new b([13],1,h),new b([14],1,h),new b([15],1,h),new b([16],1,h),new b([17],1,h),new b([18],1,h),new b([19],1,h),new b([20],1,h),new b([21],1,h),new b([22],1,h),new b([23],1,h),new b([24],1,h),new b([25],1,h),new b([26],1,h),new b([27],1,h),new b([28],1,h),new b([29],1,h),new b([30],1,h),new b([31],1,h),new b([32],1,h),new b([33],1,h),new b([34],1,h),new b([35],1,h),new b([36],1,h)];b.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b.prototype.toString=
function(a){a=+a||10;if(2>a||36<a)throw Error("illegal radix "+a+".");if(0===this._s)return"0";if(10===a){a=0>this._s?"-":"";a+=this._d[this._d.length-1].toString();for(var c=this._d.length-2;0<=c;c--){for(var k=this._d[c].toString();7>k.length;)k="0"+k;a+=k}return a}c=b.digits;a=b.small[a];for(var k=this._s,g=this.abs(),l=[],d;0!==g._s;)d=g.divRem(a),g=d[0],d=d[1],l.push(c[d.valueOf()]);return(0>k?"-":"")+l.reverse().join("")};b.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,
/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];b.parse=function(a,c){function k(a){a=
a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,b,c,g,d){d=+d;var e=0>d,f=c.length+d;a=(e?c:g).length;d=(d=Math.abs(d))>=a?d-a+e:0;a=Array(d+1).join("0");c+=g;return(b||"")+(e?c=a+c:c+=a).substr(0,f+=e?a.length:0)+(f<c.length?"."+c.substr(f):"")})}a=a.toString();if("undefined"===typeof c||10===+c)a=k(a);var g=(new RegExp("^([+\\-]?)("+("undefined"===typeof c?"0[xcb]":16==c?"0x":8==c?"0c":2==c?"0b":"")+")?([0-9a-z]*)(?:\\.\\d*)?$",
"i")).exec(a);if(g){var l=g[1]||"+",d=g[2]||"",g=g[3]||"";if("undefined"===typeof c)c="0x"===d||"0X"===d?16:"0c"===d||"0C"===d?8:"0b"===d||"0B"===d?2:10;else if(2>c||36<c)throw Error("Illegal radix "+c+".");c=+c;if(!b.radixRegex[c].test(g))throw Error("Bad digit for radix "+c);g=g.replace(/^0+/,"").split("");if(0===g.length)return n;l="-"===l?-1:1;if(10==c){for(d=[];7<=g.length;)d.push(parseInt(g.splice(g.length-b.base_log10,b.base_log10).join(""),10));d.push(parseInt(g.join(""),10));return new b(d,
l,h)}d=n;c=b.small[c];for(var f=b.small,e=0;e<g.length;e++)d=d.multiply(c).add(f[parseInt(g[e],36)]);return new b(d._d,l,h)}throw Error("Invalid BigInteger format: "+a);};b.prototype.add=function(a){if(0===this._s)return b(a);a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);var c=this._d;a=a._d;for(var k=c.length,g=a.length,l=Array(Math.max(k,g)+1),d=Math.min(k,g),f=0,e=0;e<d;e++)f=c[e]+a[e]+f,l[e]=f%1E7,f=f/1E7|0;g>k&&(c=a,k=g);for(e=d;f&&e<k;e++)f=c[e]+f,l[e]=
f%1E7,f=f/1E7|0;for(f&&(l[e]=f);e<k;e++)l[e]=c[e];return new b(l,this._s,h)};b.prototype.negate=function(){return new b(this._d,-this._s|0,h)};b.prototype.abs=function(){return 0>this._s?this.negate():this};b.prototype.subtract=function(a){if(0===this._s)return b(a).negate();a=b(a);if(0===a._s)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var c=this;0>this._s&&(c=new b(a._d,1,h),a=new b(this._d,1,h));var k=c.compareAbs(a);if(0===k)return n;if(0>k){var g=a;a=c;c=g}c=c._d;a=a._d;var g=
c.length,l=a.length,d=Array(g),f=0,e,m;for(e=0;e<l;e++)m=c[e]-f-a[e],0>m?(m+=1E7,f=1):f=0,d[e]=m;for(e=l;e<g;e++){m=c[e]-f;if(0>m)m+=1E7;else{d[e++]=m;break}d[e]=m}for(;e<g;e++)d[e]=c[e];return new b(d,k,h)};(function(){function a(a,c){for(var l=a._d,d=l.slice(),f=0;;){var e=(l[f]||0)+1;d[f]=e%1E7;if(9999999>=e)break;++f}return new b(d,c,h)}function c(a,c){for(var l=a._d,d=l.slice(),f=0;;){var e=(l[f]||0)-1;if(0>e)d[f]=e+1E7;else{d[f]=e;break}++f}return new b(d,c,h)}b.prototype.next=function(){switch(this._s){case 0:return p;
case -1:return c(this,-1);default:return a(this,1)}};b.prototype.prev=function(){switch(this._s){case 0:return s;case -1:return a(this,-1);default:return c(this,1)}}})();b.prototype.compareAbs=function(a){if(this===a)return 0;if(!(a instanceof b)){if(!isFinite(a))return isNaN(a)?a:-1;a=b(a)}if(0===this._s)return 0!==a._s?-1:0;if(0===a._s)return 1;var c=this._d.length,k=a._d.length;if(c<k)return-1;if(c>k)return 1;k=this._d;a=a._d;for(c-=1;0<=c;c--)if(k[c]!==a[c])return k[c]<a[c]?-1:1;return 0};b.prototype.compare=
function(a){if(this===a)return 0;a=b(a);return 0===this._s?-a._s:this._s===a._s?this.compareAbs(a)*this._s:this._s};b.prototype.isUnit=function(){return this===p||this===s||1===this._d.length&&1===this._d[0]};b.prototype.multiply=function(a){if(0===this._s)return n;a=b(a);if(0===a._s)return n;if(this.isUnit())return 0>this._s?a.negate():a;if(a.isUnit())return 0>a._s?this.negate():this;if(this===a)return this.square();var c=this._d.length>=a._d.length,k=(c?this:a)._d,c=(c?a:this)._d,g=k.length,l=c.length,
d=g+l,f=Array(d),e;for(e=0;e<d;e++)f[e]=0;for(e=0;e<l;e++){for(var d=0,m=c[e],p=g+e,r,q=e;q<p;q++)r=f[q]+m*k[q-e]+d,d=r/1E7|0,f[q]=r%1E7|0;d&&(r=f[q]+d,f[q]=r%1E7)}return new b(f,this._s*a._s,h)};b.prototype.multiplySingleDigit=function(a){if(0===a||0===this._s)return n;if(1===a)return this;var c;if(1===this._d.length)return c=this._d[0]*a,1E7<=c?new b([c%1E7|0,c/1E7|0],1,h):new b([c],1,h);if(2===a)return this.add(this);if(this.isUnit())return new b([a],1,h);var k=this._d,g=k.length;c=g+1;for(var l=
Array(c),d=0;d<c;d++)l[d]=0;for(var f=d=0;f<g;f++)c=a*k[f]+d,d=c/1E7|0,l[f]=c%1E7|0;d&&(l[f]=d);return new b(l,1,h)};b.prototype.square=function(){if(0===this._s)return n;if(this.isUnit())return p;var a=this._d,c=a.length,k=Array(c+c+1),g,l,d,f;for(f=0;f<c;f++)d=2*f,g=a[f]*a[f],l=g/1E7|0,k[d]=g%1E7,k[d+1]=l;for(f=0;f<c;f++){l=0;d=2*f+1;for(var e=f+1;e<c;e++,d++)g=a[e]*a[f]*2+k[d]+l,l=g/1E7|0,k[d]=g%1E7;d=c+f;g=l+k[d];l=g/1E7|0;k[d]=g%1E7;k[d+1]+=l}return new b(k,1,h)};b.prototype.quotient=function(a){return this.divRem(a)[0]};
b.prototype.divide=b.prototype.quotient;b.prototype.remainder=function(a){return this.divRem(a)[1]};b.prototype.divRem=function(a){a=b(a);if(0===a._s)throw Error("Divide by zero");if(0===this._s)return[n,n];if(1===a._d.length)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?p:s,n];case -1:return[n,this]}var c=this._s*a._s,k=a.abs(),g=this._d,l=g.length,d=[],f,e=new b([],0,h);for(e._s=1;l;)if(e._d.unshift(g[--l]),0>e.compareAbs(a))d.push(0);else{if(0===
e._s)f=0;else{var m=e._d.length;f=k._d.length;m=1E7*e._d[m-1]+e._d[m-2];f=1E7*k._d[f-1]+k._d[f-2];e._d.length>k._d.length&&(m=1E7*(m+1));f=Math.ceil(m/f)}do{m=k.multiplySingleDigit(f);if(0>=m.compareAbs(e))break;f--}while(f);d.push(f);f&&(f=e.subtract(m),e._d=f._d.slice(),0===e._d.length&&(e._s=0))}return[new b(d.reverse(),c,h),new b(e._d,this._s,h)]};b.prototype.divRemSmall=function(a){a=+a;if(0===a)throw Error("Divide by zero");var c=this._s*(0>a?-1:1);a=Math.abs(a);if(1>a||1E7<=a)throw Error("Argument out of range");
if(0===this._s)return[n,n];if(1===a||-1===a)return[1===c?this.abs():new b(this._d,c,h),n];if(1===this._d.length){var k=new b([this._d[0]/a|0],1,h);a=new b([this._d[0]%a|0],1,h);0>c&&(k=k.negate());0>this._s&&(a=a.negate());return[k,a]}for(var g=this._d.slice(),k=Array(g.length),l=0,d=0,f=0,e;g.length;)l=1E7*l+g[g.length-1],l<a?(k[f++]=0,g.pop(),d=1E7*d+l):(e=0===l?0:l/a|0,d=l-a*e,(k[f++]=e)?(g.pop(),l=d):g.pop());a=new b([d],1,h);0>this._s&&(a=a.negate());return[new b(k.reverse(),c,h),a]};b.prototype.isEven=
function(){var a=this._d;return 0===this._s||0===a.length||0===a[0]%2};b.prototype.isOdd=function(){return!this.isEven()};b.prototype.sign=function(){return this._s};b.prototype.isPositive=function(){return 0<this._s};b.prototype.isNegative=function(){return 0>this._s};b.prototype.isZero=function(){return 0===this._s};b.prototype.exp10=function(a){a=+a;if(0===a)return this;if(Math.abs(a)>Number(t))throw Error("exponent too large in BigInteger.exp10");if(0<a){for(var c=new b(this._d.slice(),this._s,
h);7<=a;a-=7)c._d.unshift(0);if(0==a)return c;c._s=1;c=c.multiplySingleDigit(Math.pow(10,a));return 0>this._s?c.negate():c}if(-a>=7*this._d.length)return n;c=new b(this._d.slice(),this._s,h);for(a=-a;7<=a;a-=7)c._d.shift();return 0==a?c:c.divRemSmall(Math.pow(10,a))[0]};b.prototype.pow=function(a){if(this.isUnit())return 0<this._s?this:b(a).isOdd()?this:this.negate();a=b(a);if(0===a._s)return p;if(0>a._s){if(0===this._s)throw Error("Divide by zero");return n}if(0===this._s)return n;if(a.isUnit())return this;
if(0<a.compareAbs(t))throw Error("exponent too large in BigInteger.pow");for(var c=this,k=p,g=b.small[2];a.isPositive()&&(!a.isOdd()||(k=k.multiply(c),!a.isUnit()));)c=c.square(),a=a.quotient(g);return k};b.prototype.modPow=function(a,c){for(var k=p,g=this;a.isPositive();)a.isOdd()&&(k=k.multiply(g).remainder(c)),a=a.quotient(b.small[2]),a.isPositive()&&(g=g.square().remainder(c));return k};b.prototype.log=function(){switch(this._s){case 0:return-Infinity;case -1:return NaN}var a=this._d.length;if(30>
7*a)return Math.log(this.valueOf());var c=Math.ceil(30/7),k=this._d.slice(a-c);return Math.log((new b(k,1,h)).valueOf())+(a-c)*Math.log(1E7)};b.prototype.valueOf=function(){return parseInt(this.toString(),10)};b.prototype.toJSValue=function(){return parseInt(this.toString(),10)};var t=b(2147483647);b.MAX_EXP=t;(function(){function a(a){return function(c){return a.call(b(c))}}function c(a){return function(c,d){return a.call(b(c),b(d))}}function k(a){return function(c,d,f){return a.call(b(c),b(d),b(f))}}
(function(){var g,h,d="toJSValue isEven isOdd sign isZero isNegative abs isUnit square negate isPositive toString next prev log".split(" "),f="compare remainder divRem subtract add quotient divide multiply pow compareAbs".split(" "),e=["modPow"];for(g=0;g<d.length;g++)h=d[g],b[h]=a(b.prototype[h]);for(g=0;g<f.length;g++)h=f[g],b[h]=c(b.prototype[h]);for(g=0;g<e.length;g++)h=e[g],b[h]=k(b.prototype[h]);b.exp10=function(a,c){return b(a).exp10(c)}})()})();u.BigInteger=b})("undefined"!==typeof exports?
exports:this);